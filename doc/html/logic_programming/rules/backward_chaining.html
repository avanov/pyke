<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <title>Backward Chaining</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../stylesheets/pyke.css" type="text/css" />
</head>
<body>
  <table id="page-table">
    <thead class="head">
        <tr id="header1"><th id="header" colspan="3">
            &nbsp;
        </th></tr>
        <tr id="header2">
          <th id="crumb-left"></th>
          <th id="crumb-line">
            <div id="nav">
              <ul>
                  <li><a href="../../index.html">Home</a></li>
<li>&gt;</li>
<li><a href="../index.html">Logic Programming</a></li>
<li>&gt;</li>
<li><a href="index.html">Rules</a></li>
<li>&gt;</li>
<li>Backward Chaining</li>

              </ul>
            </div>
          </th>
          <th id="crumb-right"></th>
        </tr>
    </thead>

    <tbody id="body">
        <tr id="body-tr">
          <td id="left-nav">
            <div id="left-nav-div">
              
<div class="title-nav"><a href="../../index.html">Home</a></div><div class="nav-branch">
<div class="normal-nav"><a href="../../about_pyke/index.html">About Pyke</a></div>

<div class="title-nav"><a href="../index.html">Logic Programming</a></div><div class="nav-branch">
<div class="normal-nav"><a href="../statements.html">Statements</a></div>
<div class="normal-nav"><a href="../pattern_matching/index.html">Pattern Matching</a></div>

<div class="title-nav"><a href="index.html">Rules</a></div><div class="nav-branch">
<div class="normal-nav"><a href="forward_chaining.html">Forward Chaining</a></div>
<div class="normal-nav"><a href="backward_chaining.html">Backward Chaining</a></div>
</div>
<div class="normal-nav"><a href="../plans.html">Plans</a></div>
</div>
<div class="normal-nav"><a href="../../knowledge_bases/index.html">Knowledge Bases</a></div>
<div class="normal-nav"><a href="../../pyke_syntax/index.html">Pyke Syntax</a></div>
<div class="normal-nav"><a href="../../using_pyke.html">Using Pyke</a></div>
<div class="normal-nav"><a href="../../examples.html">Examples</a></div>
<div class="normal-nav"><a href="../../PyCon2008-paper.html">PyCon 2008 Paper</a></div>
</div>

            </div>
            <div id="icons">
                <div id="project-page">
                  <a href="http://sourceforge.net/projects/pyke/">Pyke Project Page</a>
                </div>
                Please Make a Donation:<br />
                <a href="http://sourceforge.net/donate/index.php?group_id=207724">
                  <img src="http://images.sourceforge.net/images/project-support.jpg"
                       width="88" height="32" border="0"
                       alt="Support This Project" /> </a> <br /><br />
                Hosted by: <br />
                <!-- <a href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=207724&amp;type=3" width="125" height="37" border="0" alt="SourceForge.net Logo" /></a> -->
                <a href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=207724&amp;type=4" width="125" height="37" border="0" alt="SourceForge.net Logo" /></a>
            </div>
          </td>
          <td id="main-td">
            <div id="main">
                <a name="startcontent" id="startcontent"></a>
                <div class="document" id="backward-chaining">
<h1 class="title">Backward Chaining</h1>
<p>Backward chaining <a class="reference" href="index.html">rules</a> are processed when your program asks Pyke to <a class="reference" href="../../using_pyke.html#proving-goals">prove</a>
a specific <em>goal</em>.  Pyke will only use <a class="reference" href="../../using_pyke.html#setting-up-each-case">activated</a> <a class="reference" href="../../knowledge_bases/rule_bases.html">rule bases</a> to do the
proof.</p>
<div class="section">
<h2><a id="example" name="example">Example</a></h2>
<p>Consider this example:</p>
<pre class="literal-block">
 1  son_father
 2      use child_parent($son, $father, (), son, father)
 3      when
 4          family.son_of($son, $father, $_)

 5  son_mother
 6      use child_parent($son, $mother, (), son, mother)
 7      when
 8          family.son_of($son, $_, $mother)

 9  daughter_father
10      use child_parent($daughter, $father, (), daughter, father)
11      when
12          family.daughter_of($daughter, $father, $_)

13  daughter_mother
14      use child_parent($daughter, $mother, (), daughter, mother)
15      when
16          family.daughter_of($daughter, $_, $mother)

17  grand_parent_and_child
18      use child_parent($grand_child, $grand_parent, (grand),
19                       $grand_child_type, $grand_parent_type)
20      when
21          child_parent($grand_child, $parent, (), $grand_child_type, $_)
22          child_parent($parent, $grand_parent, (), $_, $grand_parent_type)

23  great_grand_parent_and_child
24      use child_parent($gg_child, $gg_parent, (great, $prefix1, *$rest_prefixes),
25                       $gg_child_type, $gg_parent_type)
26      when
27          child_parent($gg_child, $parent, (), $gg_child_type, $_)
28          child_parent($parent, $gg_parent, ($prefix1, *$rest_prefixes),
29                       $_, $gg_parent_type)
</pre>
</div>
<div class="section">
<h2><a id="identifying-backward-chaining-rules" name="identifying-backward-chaining-rules">Identifying Backward-Chaining Rules</a></h2>
<p>These <a class="reference" href="index.html">rules</a> draw the same conclusions as the <a class="reference" href="forward_chaining.html">forward-chaining</a> <a class="reference" href="forward_chaining.html#example">example</a>;
but you'll notice three differences:</p>
<ol class="arabic simple">
<li>The <a class="reference" href="index.html">rule's</a> <strong>if</strong> and <strong>then</strong> parts are reversed.</li>
<li>The <a class="reference" href="index.html">rules</a> use different keywords: <tt class="docutils literal"><span class="pre">use</span></tt> for the <strong>then</strong> clause
and <tt class="docutils literal"><span class="pre">when</span></tt> for the <strong>if</strong> clause.</li>
<li>The <a class="reference" href="../../knowledge_bases/fact_bases.html#facts">facts</a> established by backward-chaining do not have a knowledge
base name prefix.  In this case, the knowledge base name defaults to
the <a class="reference" href="../../knowledge_bases/rule_bases.html#rule-base-categories">rule base category</a> of this <a class="reference" href="../../knowledge_bases/rule_bases.html">rule base</a> (it's root rule base name).</li>
</ol>
</div>
<div class="section">
<h2><a id="how-backward-chaining-rules-are-run" name="how-backward-chaining-rules-are-run">How Backward-Chaining Rules are Run</a></h2>
<p>These <a class="reference" href="index.html">rules</a> are not used until you ask Pyke to <a class="reference" href="../../using_pyke.html#proving-goals">prove</a> a goal.</p>
<p>The easiest way to do this is with
<em>some_engine</em>.prove_1_ or <em>some_engine</em>.prove_n_.  <a class="reference" href="../../using_pyke.html#proving-goals">Prove_1</a> only
returns the first proof found and then stops (or raises pyke.CanNotProve).
<a class="reference" href="../../using_pyke.html#proving-goals">Prove_n</a> is a generator that generates all possible proofs (which, in
some cases, might be infinite).  In both cases, you pass a tuple of
arguments and the number of variable arguments as the last two parameters.
The total number of arguments for the goal is the sum of the length of the
actual arguments that you pass plus the number of variable arguments that you
specify.</p>
<p>Both functions return the variable bindings for the number of variable
arguments you specified as a tuple, along with the <a class="reference" href="../plans.html">plan</a>.</p>
</div>
<div class="section">
<h2><a id="running-the-example" name="running-the-example">Running the Example</a></h2>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; from pyke import knowledge_engine
&gt;&gt;&gt; engine = knowledge_engine.engine('examples')
&gt;&gt;&gt; engine.assert_('family', 'son_of', ('michael', 'bruce', 'marilyn'))
&gt;&gt;&gt; engine.assert_('family', 'son_of', ('bruce', 'thomas', 'norma'))
&gt;&gt;&gt; engine.assert_('family', 'daughter_of', ('norma', 'allen', 'ismay'))
&gt;&gt;&gt; engine.activate('bc_example')
&gt;&gt;&gt; for vars, no_plan in engine.prove_n('bc_example', 'child_parent',
...                                     ('michael',), 4):
...     print vars
('bruce', (), 'son', 'father')
('marilyn', (), 'son', 'mother')
('thomas', ('grand',), 'son', 'father')
('norma', ('grand',), 'son', 'mother')
('allen', ('great', 'grand'), 'son', 'father')
('ismay', ('great', 'grand'), 'son', 'mother')
</pre>
</blockquote>
<p>Pyke performs the proof by:</p>
<ol class="arabic simple">
<li>Checking to see if the goal is simply a known <a class="reference" href="../../knowledge_bases/fact_bases.html#facts">fact</a>.
If so, it has a proof!</li>
<li>Look for the first backward-chaining <a class="reference" href="index.html">rule</a> that concludes the goal
in its <tt class="docutils literal"><span class="pre">use</span></tt> clause.<ul>
<li>If not found, the goal fails.</li>
<li>If found, try to recursively prove all of the subgoals in the
<a class="reference" href="index.html">rule's</a> <tt class="docutils literal"><span class="pre">when</span></tt> clause.<ul>
<li>If this succeeds, the goal is proven.</li>
<li>If this fails, go back to step 2 and look for the next rule
that concludes the goal in its <tt class="docutils literal"><span class="pre">use</span></tt> clause.</li>
</ul>
</li>
</ul>
</li>
</ol>
</div>
<div class="section">
<h2><a id="backward-chaining-defined" name="backward-chaining-defined">Backward-Chaining Defined</a></h2>
<p>Note how the <a class="reference" href="index.html">rules</a> are combined in the opposite direction from
<a class="reference" href="forward_chaining.html">forward-chaining</a> <a class="reference" href="index.html">rules</a>.  Here the first <a class="reference" href="index.html">rule's</a> <strong>if</strong> (<tt class="docutils literal"><span class="pre">when</span></tt>) clause is
linked backwards to the next rule's <strong>then</strong> (<tt class="docutils literal"><span class="pre">use</span></tt>) clause.</p>
<p>This is why these rules are called <em>backward-chaining</em> rules.  This is also
referred to as <em>goal directed</em>, since the inferencing is driven by the final
goal.</p>
</div>
<div class="section">
<h2><a id="backtracking" name="backtracking">Backtracking</a></h2>
<p>Also note that while processing each subgoal within a <a class="reference" href="index.html">rule's</a> <tt class="docutils literal"><span class="pre">when</span></tt> clause:</p>
<ul class="simple">
<li>If Pyke succeeds at proving the subgoal:<ul>
<li>Pyke will proceed to the next subgoal within the <tt class="docutils literal"><span class="pre">when</span></tt> clause.</li>
<li>If Pyke reaches the end of the <tt class="docutils literal"><span class="pre">when</span></tt> clause, the <a class="reference" href="index.html">rule</a> succeeds.</li>
</ul>
</li>
<li>If Pyke fails at proving the subgoal:<ul>
<li>Pyke will back up to the prior subgoal within the <tt class="docutils literal"><span class="pre">when</span></tt> clause
and try to find another proof for it.  The process starts over
from this prior subgoal, going forward or backing up depending on
whether another proof can be found.</li>
<li>If Pyke reaches the beginning of the <tt class="docutils literal"><span class="pre">when</span></tt> clause, the <a class="reference" href="index.html">rule</a>
fails.</li>
</ul>
</li>
</ul>
<p>Thus, execution within each <a class="reference" href="index.html">rule's</a> <tt class="docutils literal"><span class="pre">when</span></tt> clause proceeds both forwards
and backwards up and down the list of subgoals, depending on whether each
subgoal succeeds or fails.  The process of backing up in the <tt class="docutils literal"><span class="pre">when</span></tt>
clause to try alternate subproofs is called <em>backtracking</em>.</p>
</div>
</div>

                <!-- <div id="return-to-top">
                       <a href="#">Return to Top</a>
                     </div>
                -->
            </div>
          </td>
          <td id="right-nav">
            <div id="right-nav-div">
                <h3>More:</h3>
<div class="right-item"><a href="forward_chaining.html">Forward Chaining</a><p>Explanation of forward-chaining rules.</p>
</div>
<div class="right-item"><a href="backward_chaining.html">Backward Chaining</a><p>Explanation of backward-chaining rules.</p>
</div>

            </div>
          </td>
        </tr>
    </tbody>

    <tfoot id="foot">
        <tr id="foot2">
          <td id="copyright" colspan="3">
            Copyright &copy; 2007 Bruce Frederiksen
          </td>
        </tr>
    </tfoot>
  </table>

  <div id="last-modified">
    Page last modified Tue, Aug 12 2008.
  </div>

</body>
</html>
